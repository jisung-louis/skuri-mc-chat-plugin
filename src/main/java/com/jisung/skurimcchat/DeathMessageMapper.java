package com.jisung.skurimcchat;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class DeathMessageMapper {

    public static String translate(String raw) {
        if (raw == null || raw.isEmpty()) return raw;

        // STEP 1 — 패턴 기반 정규식 매핑 ------------------------------
        // 정규식 매핑 배열: { regex, replacementPattern }
        Object[][] regexPatterns = new Object[][] {

            // ==========================================================
            // PROJECTILES / RANGED
            // ==========================================================
            { "(.+) was shot by (.+)", "%1$s이(가) %2$s에게 저격당했습니다" },
            { "(.+) was shot by (.+) using (.+)", "%1$s이(가) %2$s이(가) %3$s(으)로 저격당했습니다" },
            { "(.+) was arrowed by (.+)", "%1$s이(가) %2$s의 화살에 맞았습니다" },

            // ==========================================================
            // GENERIC KILLED BY
            // ==========================================================
            { "(.+) was killed by (.+)", "%1$s이(가) %2$s에게 살해되었습니다" },
            { "(.+) was killed by (.+) using (.+)", "%1$s이(가) %2$s이(가) %3$s(으)로 살해되었습니다" },
            { "(.+) was killed by magic", "%1$s이(가) 마법 피해로 사망했습니다" },

            // ==========================================================
            // MELEE / SLASHING
            // ==========================================================
            { "(.+) was slain by (.+)", "%1$s이(가) %2$s에게 살해되었습니다" },
            { "(.+) was slain by (.+) using (.+)", "%1$s이(가) %2$s이(가) %3$s(으)로 살해되었습니다" },

            // ==========================================================
            // FALL DAMAGE
            // ==========================================================
            { "(.+) fell from a high place", "%1$s이(가) 높은 곳에서 떨어졌습니다" },
            { "(.+) fell off (.+)", "%1$s이(가) %2$s에서 떨어졌습니다" },
            { "(.+) fell off a ladder", "%1$s이(가) 사다리에서 떨어졌습니다" },
            { "(.+) fell off some vines", "%1$s이(가) 덩굴에서 떨어졌습니다" },
            { "(.+) fell while climbing", "%1$s이(가) 오르던 중 떨어졌습니다" },
            { "(.+) hit the ground too hard", "%1$s이(가) 땅바닥으로 곤두박질쳤습니다" },
            { "(.+) hit the ground too hard while trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 곤두박질쳤습니다" },

            // ==========================================================
            // VOID / OUT OF WORLD
            // ==========================================================
            { "(.+) fell out of the world", "%1$s이(가) 세계 밖으로 떨어졌습니다" },
            { "(.+) fell out of the world and was killed by (.+)", "%1$s이(가) 세계 밖으로 떨어져 %2$s에게 사망했습니다" },

            // ==========================================================
            // FIRE / LAVA
            // ==========================================================
            { "(.+) went up in flames", "%1$s이(가) 화염에 휩싸였습니다" },
            { "(.+) burned to death", "%1$s이(가) 불에 타 죽었습니다" },
            { "(.+) was burnt to a crisp", "%1$s이(가) 바삭해지도록 타죽었습니다" },
            { "(.+) was burnt to a crisp whilst fighting (.+)", "%1$s이(가) %2$s과(와) 싸우다가 바삭하게 타죽었습니다" },
            { "(.+) tried to swim in lava", "%1$s이(가) 용암에서 수영하려 했습니다" },
            { "(.+) tried to swim in lava while trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 용암에서 수영을 시도했습니다" },
            { "(.+) walked into fire", "%1$s이(가) 불에 걸어들어갔습니다" },
            { "(.+) walked into fire whilst fighting (.+)", "%1$s이(가) %2$s과(와) 싸우다가 불에 빠졌습니다" },
            { "(.+) walked into a fire whilst trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 불에 빠졌습니다" },

            // ==========================================================
            // DROWNING
            // ==========================================================
            { "(.+) drowned", "%1$s이(가) 익사했습니다" },
            { "(.+) drowned whilst trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 익사했습니다" },

            // ==========================================================
            // FREEZING
            // ==========================================================
            { "(.+) froze to death", "%1$s이(가) 얼어 죽었습니다" },
            { "(.+) was frozen to death by (.+)", "%1$s이(가) %2$s에게 얼려 죽었습니다" },

            // ==========================================================
            // LIGHTNING
            // ==========================================================
            { "(.+) was struck by lightning", "%1$s이(가) 번개에 맞았습니다" },
            { "(.+) was struck by lightning whilst fighting (.+)", "%1$s이(가) %2$s과(와) 싸우다가 번개에 맞았습니다" },

            // ==========================================================
            // EXPLOSIONS
            // ==========================================================
            { "(.+) blew up", "%1$s이(가) 폭사했습니다" },
            { "(.+) blew up while trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 폭사했습니다" },
            { "(.+) was blown up by (.+)", "%1$s이(가) %2$s 때문에 폭사했습니다" },
            { "(.+) was blown up by (.+) using (.+)", "%1$s이(가) %2$s이(가) %3$s(으)로 폭사했습니다" },
            { "(.+) went off with a bang", "%1$s이(가) 굉음과 함께 폭사했습니다" },

            // ==========================================================
            // STARVATION / DEHYDRATION
            // ==========================================================
            { "(.+) starved to death", "%1$s이(가) 굶어 죽었습니다" },
            { "(.+) died from dehydration", "%1$s이(가) 탈수로 사망했습니다" },
            { "(.+) died from dehydration while trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치다 탈수로 사망했습니다" },

            // ==========================================================
            // CACTUS
            // ==========================================================
            { "(.+) was pricked to death", "%1$s이(가) 찔려 사망했습니다" },
            { "(.+) walked into a cactus whilst trying to escape (.+)", "%1$s이(가) %2$s에게서 도망치려다 선인장에 찔렸습니다" },

            // ==========================================================
            // ANVIL / BLOCK / STALACTITE
            // ==========================================================
            { "(.+) was squashed by a falling anvil", "%1$s이(가) 떨어지는 모루에 짓눌렸습니다" },
            { "(.+) was squashed by a falling block", "%1$s이(가) 떨어지는 블록에 짓눌렸습니다" },
            { "(.+) was skewered by a falling stalactite", "%1$s이(가) 떨어지는 종유석에 찔렸습니다" },
            { "(.+) was impaled on a stalagmite", "%1$s이(가) 솟은 종유석에 꿰뚫렸습니다" },

            // ==========================================================
            // FIREBALL / GHAST / BLAZE
            // ==========================================================
            { "(.+) was fireballed by (.+)", "%1$s이(가) %2$s이(가) 던진 화염구에 맞았습니다" },

            // ==========================================================
            // THORNS
            // ==========================================================
            { "(.+) was killed trying to hurt (.+)", "%1$s이(가) %2$s을(를) 공격하려다 부메랑 피해로 사망했습니다" },

            // ==========================================================
            // SWEET BERRY BUSH
            // ==========================================================
            { "(.+) was poked to death by a sweet berry bush", "%1$s이(가) 달콤한 열매 덤불에 찔려 죽었습니다" },

            // ==========================================================
            // DRAGON BREATH
            // ==========================================================
            { "(.+) was roasted in dragon's breath", "%1$s이(가) 드래곤의 숨결에 구워졌습니다" },
            { "(.+) was roasted in dragon's breath by (.+)", "%1$s이(가) %2$s 때문에 드래곤의 숨결에 구워졌습니다" },

            // ==========================================================
            // WITHER / POISON / EFFECTS
            // ==========================================================
            { "(.+) withered away", "%1$s이(가) 시들어 죽었습니다" },
            { "(.+) was withered by (.+)", "%1$s이(가) %2$s에게 위더 효과로 죽었습니다" },

            // ==========================================================
            // SUFFOCATION
            // ==========================================================
            { "(.+) suffocated in a wall", "%1$s이(가) 벽 속에서 질식했습니다" },

            // ==========================================================
            // CRAMMING
            // ==========================================================
            { "(.+) was squished too much", "%1$s이(가) 과밀로 압사했습니다" },
            { "(.+) was squashed by (.+)", "%1$s이(가) %2$s에게 압사했습니다" }
        };

        // 패턴 검사 및 매핑 적용
        for (Object[] entry : regexPatterns) {
            String pattern = (String) entry[0];
            String replacement = (String) entry[1];

            if (raw.matches(pattern)) {
                Matcher m = Pattern.compile(pattern).matcher(raw);
                if (m.find()) {
                    String result = replacement;
                    for (int i = 1; i <= m.groupCount(); i++) {
                        result = result.replace("%" + i + "$s", m.group(i));
                    }
                    return result;
                }
            }
        }

        // 매핑 실패 시 원문 반환
        return raw;
    }
}
